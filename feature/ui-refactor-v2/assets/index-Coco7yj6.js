var O=Object.defineProperty;var P=(a,e,r)=>e in a?O(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r;var S=(a,e,r)=>P(a,typeof e!="symbol"?e+"":e,r);import{e as H,c as D,g as Y,h as b,t as _,n as p,j as B,k as R,i as C,I as k,w as A,B as $,l as N}from"./index-DqB3RId5.js";import{g as L,d as I,e as t,F as z,B as K}from"./vendor-axiUcNeZ.js";import{u as J}from"./index-DQNE7AqK.js";import{y as G}from"./useDegWasm-CIgNaXDF.js";let V=0;function U(){const a=L(),{name:e="unknown"}=(a==null?void 0:a.type)||{};return`${e}-${++V}`}const[q,g]=D("cell"),X={tag:B("div"),icon:String,size:String,title:p,value:p,label:p,center:Boolean,isLink:Boolean,border:_,iconPrefix:String,valueClass:b,labelClass:b,titleClass:b,titleStyle:null,arrowDirection:String,required:{type:[Boolean,String],default:null},clickable:{type:Boolean,default:null}},Z=H({},X,R);var j=I({name:q,props:Z,setup(a,{slots:e}){const r=Y(),i=()=>{if(e.label||C(a.label))return t("div",{class:[g("label"),a.labelClass]},[e.label?e.label():a.label])},d=()=>{var s;if(e.title||C(a.title)){const u=(s=e.title)==null?void 0:s.call(e);return Array.isArray(u)&&u.length===0?void 0:t("div",{class:[g("title"),a.titleClass],style:a.titleStyle},[u||t("span",null,[a.title]),i()])}},l=()=>{const s=e.value||e.default;if(s||C(a.value))return t("div",{class:[g("value"),a.valueClass]},[s?s():t("span",null,[a.value])])},n=()=>{if(e.icon)return e.icon();if(a.icon)return t(k,{name:a.icon,class:g("left-icon"),classPrefix:a.iconPrefix},null)},o=()=>{if(e["right-icon"])return e["right-icon"]();if(a.isLink){const s=a.arrowDirection&&a.arrowDirection!=="right"?`arrow-${a.arrowDirection}`:"arrow";return t(k,{name:s,class:g("right-icon")},null)}};return()=>{var s;const{tag:u,size:h,center:m,border:F,isLink:E,required:w}=a,y=(s=a.clickable)!=null?s:E,v={center:m,required:!!w,clickable:y,borderless:!F};return h&&(v[h]=!!h),t(u,{class:g(v),role:y?"button":void 0,tabindex:y?0:void 0,onClick:r},{default:()=>{var c;return[n(),d(),l(),o(),(c=e.extra)==null?void 0:c.call(e)]}})}}});const dt=A(j),[W,M]=D("cell-group"),Q={title:String,inset:Boolean,border:_};var tt=I({name:W,inheritAttrs:!1,props:Q,setup(a,{slots:e,attrs:r}){const i=()=>{var l;return t("div",K({class:[M({inset:a.inset}),{[$]:a.border&&!a.inset}]},r,J()),[(l=e.default)==null?void 0:l.call(e)])},d=()=>t("div",{class:M("title",{inset:a.inset})},[e.title?e.title():a.title]);return()=>a.title||e.title?t(z,null,[d(),i()]):i()}});const ut=A(tt),[et,x]=D("empty"),rt={image:B("default"),imageSize:[Number,String,Array],description:String};var at=I({name:et,props:rt,setup(a,{slots:e}){const r=()=>{const c=e.description?e.description():a.description;if(c)return t("p",{class:x("description")},[c])},i=()=>{if(e.default)return t("div",{class:x("bottom")},[e.default()])},d=U(),l=c=>`${d}-${c}`,n=c=>`url(#${l(c)})`,o=(c,f,T)=>t("stop",{"stop-color":c,offset:`${f}%`,"stop-opacity":T},null),s=(c,f)=>[o(c,0),o(f,100)],u=c=>[t("defs",null,[t("radialGradient",{id:l(c),cx:"50%",cy:"54%",fx:"50%",fy:"54%",r:"297%",gradientTransform:"matrix(-.16 0 0 -.33 .58 .72)","data-allow-mismatch":"attribute"},[o("#EBEDF0",0),o("#F2F3F5",100,.3)])]),t("ellipse",{fill:n(c),opacity:".8",cx:"80",cy:"140",rx:"46",ry:"8","data-allow-mismatch":"attribute"},null)],h=()=>[t("defs",null,[t("linearGradient",{id:l("a"),x1:"64%",y1:"100%",x2:"64%","data-allow-mismatch":"attribute"},[o("#FFF",0,.5),o("#F2F3F5",100)])]),t("g",{opacity:".8","data-allow-mismatch":"children"},[t("path",{d:"M36 131V53H16v20H2v58h34z",fill:n("a")},null),t("path",{d:"M123 15h22v14h9v77h-31V15z",fill:n("a")},null)])],m=()=>[t("defs",null,[t("linearGradient",{id:l("b"),x1:"64%",y1:"97%",x2:"64%",y2:"0%","data-allow-mismatch":"attribute"},[o("#F2F3F5",0,.3),o("#F2F3F5",100)])]),t("g",{opacity:".8","data-allow-mismatch":"children"},[t("path",{d:"M87 6c3 0 7 3 8 6a8 8 0 1 1-1 16H80a7 7 0 0 1-8-6c0-4 3-7 6-7 0-5 4-9 9-9Z",fill:n("b")},null),t("path",{d:"M19 23c2 0 3 1 4 3 2 0 4 2 4 4a4 4 0 0 1-4 3v1h-7v-1l-1 1c-2 0-3-2-3-4 0-1 1-3 3-3 0-2 2-4 4-4Z",fill:n("b")},null)])],F=()=>t("svg",{viewBox:"0 0 160 160"},[t("defs",{"data-allow-mismatch":"children"},[t("linearGradient",{id:l(1),x1:"64%",y1:"100%",x2:"64%"},[o("#FFF",0,.5),o("#F2F3F5",100)]),t("linearGradient",{id:l(2),x1:"50%",x2:"50%",y2:"84%"},[o("#EBEDF0",0),o("#DCDEE0",100,0)]),t("linearGradient",{id:l(3),x1:"100%",x2:"100%",y2:"100%"},[s("#EAEDF0","#DCDEE0")]),t("radialGradient",{id:l(4),cx:"50%",cy:"0%",fx:"50%",fy:"0%",r:"100%",gradientTransform:"matrix(0 1 -.54 0 .5 -.5)"},[o("#EBEDF0",0),o("#FFF",100,0)])]),t("g",{fill:"none"},[h(),t("path",{fill:n(4),d:"M0 139h160v21H0z","data-allow-mismatch":"attribute"},null),t("path",{d:"M80 54a7 7 0 0 1 3 13v27l-2 2h-2a2 2 0 0 1-2-2V67a7 7 0 0 1 3-13z",fill:n(2),"data-allow-mismatch":"attribute"},null),t("g",{opacity:".6","stroke-linecap":"round","stroke-width":"7","data-allow-mismatch":"children"},[t("path",{d:"M64 47a19 19 0 0 0-5 13c0 5 2 10 5 13",stroke:n(3)},null),t("path",{d:"M53 36a34 34 0 0 0 0 48",stroke:n(3)},null),t("path",{d:"M95 73a19 19 0 0 0 6-13c0-5-2-9-6-13",stroke:n(3)},null),t("path",{d:"M106 84a34 34 0 0 0 0-48",stroke:n(3)},null)]),t("g",{transform:"translate(31 105)"},[t("rect",{fill:"#EBEDF0",width:"98",height:"34",rx:"2"},null),t("rect",{fill:"#FFF",x:"9",y:"8",width:"80",height:"18",rx:"1.1"},null),t("rect",{fill:"#EBEDF0",x:"15",y:"12",width:"18",height:"6",rx:"1.1"},null)])])]),E=()=>t("svg",{viewBox:"0 0 160 160"},[t("defs",{"data-allow-mismatch":"children"},[t("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:l(5)},[s("#F2F3F5","#DCDEE0")]),t("linearGradient",{x1:"95%",y1:"48%",x2:"5.5%",y2:"51%",id:l(6)},[s("#EAEDF1","#DCDEE0")]),t("linearGradient",{y1:"45%",x2:"100%",y2:"54%",id:l(7)},[s("#EAEDF1","#DCDEE0")])]),h(),m(),t("g",{transform:"translate(36 50)",fill:"none"},[t("g",{transform:"translate(8)"},[t("rect",{fill:"#EBEDF0",opacity:".6",x:"38",y:"13",width:"36",height:"53",rx:"2"},null),t("rect",{fill:n(5),width:"64",height:"66",rx:"2","data-allow-mismatch":"attribute"},null),t("rect",{fill:"#FFF",x:"6",y:"6",width:"52",height:"55",rx:"1"},null),t("g",{transform:"translate(15 17)",fill:n(6),"data-allow-mismatch":"attribute"},[t("rect",{width:"34",height:"6",rx:"1"},null),t("path",{d:"M0 14h34v6H0z"},null),t("rect",{y:"28",width:"34",height:"6",rx:"1"},null)])]),t("rect",{fill:n(7),y:"61",width:"88",height:"28",rx:"1","data-allow-mismatch":"attribute"},null),t("rect",{fill:"#F7F8FA",x:"29",y:"72",width:"30",height:"6",rx:"1"},null)])]),w=()=>t("svg",{viewBox:"0 0 160 160"},[t("defs",null,[t("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:l(8),"data-allow-mismatch":"attribute"},[s("#EAEDF1","#DCDEE0")])]),h(),m(),u("c"),t("path",{d:"m59 60 21 21 21-21h3l9 9v3L92 93l21 21v3l-9 9h-3l-21-21-21 21h-3l-9-9v-3l21-21-21-21v-3l9-9h3Z",fill:n(8),"data-allow-mismatch":"attribute"},null)]),y=()=>t("svg",{viewBox:"0 0 160 160"},[t("defs",{"data-allow-mismatch":"children"},[t("linearGradient",{x1:"50%",y1:"100%",x2:"50%",id:l(9)},[s("#EEE","#D8D8D8")]),t("linearGradient",{x1:"100%",y1:"50%",y2:"50%",id:l(10)},[s("#F2F3F5","#DCDEE0")]),t("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:l(11)},[s("#F2F3F5","#DCDEE0")]),t("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:l(12)},[s("#FFF","#F7F8FA")])]),h(),m(),u("d"),t("g",{transform:"rotate(-45 113 -4)",fill:"none","data-allow-mismatch":"children"},[t("rect",{fill:n(9),x:"24",y:"52.8",width:"5.8",height:"19",rx:"1"},null),t("rect",{fill:n(10),x:"22.1",y:"67.3",width:"9.9",height:"28",rx:"1"},null),t("circle",{stroke:n(11),"stroke-width":"8",cx:"27",cy:"27",r:"27"},null),t("circle",{fill:n(12),cx:"27",cy:"27",r:"16"},null),t("path",{d:"M37 7c-8 0-15 5-16 12",stroke:n(11),"stroke-width":"3",opacity:".5","stroke-linecap":"round",transform:"rotate(45 29 13)"},null)])]),v=()=>{var c;if(e.image)return e.image();const f={error:w,search:y,network:F,default:E};return((c=f[a.image])==null?void 0:c.call(f))||t("img",{src:a.image},null)};return()=>t("div",{class:x()},[t("div",{class:x("image"),style:N(a.imageSize)},[v()]),r(),i()])}});const ht=A(at);class it{constructor(){S(this,"STORAGE_KEY","beancount_yaml_configs");S(this,"HISTORY_KEY","beancount_yaml_config_history")}getConfig(e){try{const r=localStorage.getItem(this.STORAGE_KEY);return r&&JSON.parse(r)[e]||null}catch(r){return console.error("Failed to load YAML config:",r),null}}removeConfig(e){try{const r=localStorage.getItem(this.STORAGE_KEY);if(!r)return;const i=JSON.parse(r);delete i[e],localStorage.setItem(this.STORAGE_KEY,JSON.stringify(i))}catch(r){console.error("Failed to remove config:",r)}}saveConfig(e,r){try{const i=localStorage.getItem(this.STORAGE_KEY),d=i?JSON.parse(i):{};d[e]=r,localStorage.setItem(this.STORAGE_KEY,JSON.stringify(d)),this.saveToHistory(e,r)}catch(i){console.error("Failed to save YAML config:",i)}}getDefaultConfig(e){const r={defaultMinusAccount:"Assets:FIXME",defaultPlusAccount:"Expenses:FIXME",defaultCommissionAccount:"Expenses:Commission:FIXME",defaultCurrency:"CNY",title:"BeanBridge 财务记录"};return e==="oklink"?r.oklink={"0x你的地址":{defaultCashAccount:"Assets:Crypto:Ethereum",rules:[{tokenSymbol:"USDT",methodAccount:"Assets:Crypto:Ethereum:USDT",targetAccount:"Income:Crypto:Transfer"}]}}:r[e]={rules:[]},G.stringify(r,{indent:2,lineWidth:0,minContentWidth:0})}async loadFromExample(e){try{const i=await fetch(`/beanBridge/feature/ui-refactor-v2/example/${e}/config.yaml`);if(i.ok)return await i.text();const d=`https://raw.githubusercontent.com/deb-sig/double-entry-generator/master/example/${e}/config.yaml`,l=await fetch(d);return l.ok?await l.text():null}catch(r){return console.error("Failed to load example config:",r),null}}validateConfig(e){try{const r=G.parse(e);return!r||typeof r!="object"?{valid:!1,error:"配置必须是对象格式"}:r.defaultMinusAccount?r.defaultPlusAccount?r.defaultCurrency?{valid:!0,config:r}:{valid:!1,error:"缺少必需字段: defaultCurrency"}:{valid:!1,error:"缺少必需字段: defaultPlusAccount"}:{valid:!1,error:"缺少必需字段: defaultMinusAccount"}}catch(r){return{valid:!1,error:r instanceof Error?r.message:"YAML 解析失败"}}}exportConfig(e){return this.getConfig(e)}importConfig(e,r){return this.validateConfig(r).valid?(this.saveConfig(e,r),!0):!1}getHistory(e){try{const r=localStorage.getItem(this.HISTORY_KEY),i=r?JSON.parse(r):[];return e?i.filter(d=>d.provider===e):i}catch(r){return console.error("Failed to load history:",r),[]}}saveToHistory(e,r){try{const i=this.getHistory(),d={id:this.generateId(),provider:e,content:r,createdAt:new Date().toISOString()};i.unshift(d);const l=new Map;for(const o of i)l.has(o.provider)||l.set(o.provider,[]),l.get(o.provider).push(o);const n=[];for(const[,o]of l)n.push(...o.slice(0,5));n.sort((o,s)=>new Date(s.createdAt).getTime()-new Date(o.createdAt).getTime()),localStorage.setItem(this.HISTORY_KEY,JSON.stringify(n))}catch(i){console.error("Failed to save to history:",i)}}applyHistory(e){try{const i=this.getHistory().find(d=>d.id===e);return i?(this.saveConfig(i.provider,i.content),i.content):null}catch(r){return console.error("Failed to apply history:",r),null}}deleteHistory(e){try{const r=this.getHistory(),i=r.filter(d=>d.id!==e);return i.length===r.length?!1:(localStorage.setItem(this.HISTORY_KEY,JSON.stringify(i)),!0)}catch(r){return console.error("Failed to delete history:",r),!1}}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}}const ft=new it;export{ut as C,ht as E,dt as a,ft as y};
