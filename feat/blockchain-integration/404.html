<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>BeanBridge - 加载中...</title>
  <script>
    // GitHub Pages SPA 路由修复
    // 自动检测 base path 并重定向到正确的路径
    (function() {
      var l = window.location;
      var pathname = l.pathname;
      
      // 检测 base path 和 route path
      // 路径格式：/beanBridge/分支名/路由路径
      // 例如：/beanBridge/feat/feature-enhancement/rule-config
      // base path：/beanBridge/feat/feature-enhancement/
      // route path：rule-config
      
      var beanBridgeIndex = pathname.indexOf('/beanBridge/');
      var basePath, routePath;
      
      if (beanBridgeIndex === -1) {
        // 如果没有找到 /beanBridge/，可能是根路径部署
        basePath = '/';
        routePath = pathname.slice(1);
      } else {
        // 找到 /beanBridge/，提取 base path 和 route path
        var afterBeanBridge = pathname.slice(beanBridgeIndex + '/beanBridge/'.length);
        var pathParts = afterBeanBridge.split('/').filter(function(p) { return p; });
        
        if (pathParts.length === 0) {
          // 只有 /beanBridge/，没有其他路径
          basePath = '/beanBridge/';
          routePath = '';
        } else {
          // 查找已知的路由路径（Vue Router 定义的路由）
          // 已知路由：bill-processing, rule-config, bill-processing-old, rule-config-old
          var knownRoutes = ['bill-processing', 'rule-config', 'bill-processing-old', 'rule-config-old'];
          var routeIndex = -1;
          
          for (var i = 0; i < pathParts.length; i++) {
            if (knownRoutes.indexOf(pathParts[i]) !== -1) {
              routeIndex = i;
              break;
            }
          }
          
          if (routeIndex === -1) {
            // 没有找到已知路由，假设最后一个路径段是路由，前面的都是 base path
            // 例如：/beanBridge/feat/feature-enhancement/some-route
            // base path：/beanBridge/feat/feature-enhancement/
            // route path：some-route
            if (pathParts.length > 1) {
              basePath = '/beanBridge/' + pathParts.slice(0, -1).join('/') + '/';
              routePath = pathParts[pathParts.length - 1];
            } else {
              // 只有一个路径段，可能是 base path（分支名），没有路由
              basePath = '/beanBridge/' + pathParts[0] + '/';
              routePath = '';
            }
          } else {
            // 找到已知路由，前面的都是 base path（分支名）
            basePath = '/beanBridge/' + pathParts.slice(0, routeIndex).join('/') + '/';
            routePath = pathParts.slice(routeIndex).join('/');
          }
        }
      }
      
      // 构建重定向 URL
      var redirectUrl = l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '') + basePath;
      
      // 如果有路由路径，通过 query 参数传递（Vue Router 会处理）
      if (routePath) {
        redirectUrl += '?/' + routePath.replace(/&/g, '~and~');
      }
      
      // 添加原始查询参数
      if (l.search && l.search.length > 1) {
        redirectUrl += (routePath ? '&' : '?') + l.search.slice(1).replace(/&/g, '~and~');
      }
      
      // 添加 hash
      if (l.hash) {
        redirectUrl += l.hash;
      }
      
      // 执行重定向
      l.replace(redirectUrl);
    })();
  </script>
</head>
<body>
  <div style="text-align: center; padding: 50px; font-family: sans-serif;">
    <h2>页面加载中...</h2>
    <p>正在跳转，请稍候...</p>
  </div>
</body>
</html>

