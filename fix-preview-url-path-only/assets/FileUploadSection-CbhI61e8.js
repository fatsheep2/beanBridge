import{t as D,m as W,n as N,c as se,z as Ke,E as Le,F as De,G as qe,o as Je,u as Fe,d as me,J as xe,q as he,K as H,w as fe,C as Qe,e as le,h as be,L as oe,I as K,x as ne,j as G,i as $e,M as Ae,r as et,b as Ee,N as tt,O as Me,D as de,H as at,v as Xe,Q as Ue,R as ot,l as Ye,A as nt,S as lt,_ as it}from"./index-Bsa-lGkr.js";import{d as p,r as A,k as ce,c as B,l as j,o as ye,G as st,C as ct,D as Pe,e as d,H as ie,K as rt,g as ut,m as ke,L as dt,B as ve,v as Ie,a as ze,x as vt,w as ft,b as ee,t as Re,i as _e}from"./vendor-axiUcNeZ.js";import{L as Ve,B as mt}from"./ProviderSelector-B-chnpru.js";import{a as Ze,P as gt}from"./index-MdBtHYBW.js";import{u as re}from"./use-expose-e2qxs-ZR.js";const[je,ge]=se("swipe"),ht={loop:D,width:N,height:N,vertical:Boolean,autoplay:W(0),duration:W(500),touchable:D,lazyRender:Boolean,initialSwipe:W(0),indicatorColor:String,showIndicators:D,stopPropagation:D},He=Symbol(je);var wt=p({name:je,props:ht,emits:["change","dragStart","dragEnd"],setup(e,{emit:n,slots:l}){const t=A(),i=A(),a=ce({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let S=!1;const b=Ze(),{children:m,linkChildren:g}=Ke(He),o=B(()=>m.length),v=B(()=>a[e.vertical?"height":"width"]),s=B(()=>e.vertical?b.deltaY.value:b.deltaX.value),w=B(()=>a.rect?(e.vertical?a.rect.height:a.rect.width)-v.value*o.value:0),k=B(()=>v.value?Math.ceil(Math.abs(w.value)/v.value):o.value),T=B(()=>o.value*v.value),f=B(()=>(a.active+o.value)%o.value),_=B(()=>{const u=e.vertical?"vertical":"horizontal";return b.direction.value===u}),E=B(()=>{const u={transitionDuration:`${a.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${+a.offset.toFixed(2)}px)`};if(v.value){const I=e.vertical?"height":"width",R=e.vertical?"width":"height";u[I]=`${T.value}px`,u[R]=e[R]?`${e[R]}px`:""}return u}),P=u=>{const{active:I}=a;return u?e.loop?H(I+u,-1,o.value):H(I+u,0,k.value):I},M=(u,I=0)=>{let R=u*v.value;e.loop||(R=Math.min(R,-w.value));let Z=I-R;return e.loop||(Z=H(Z,w.value,0)),Z},z=({pace:u=0,offset:I=0,emitChange:R})=>{if(o.value<=1)return;const{active:Z}=a,Y=P(u),ue=M(Y,I);if(e.loop){if(m[0]&&ue!==w.value){const Ce=ue<w.value;m[0].setOffset(Ce?T.value:0)}if(m[o.value-1]&&ue!==0){const Ce=ue>0;m[o.value-1].setOffset(Ce?-T.value:0)}}a.active=Y,a.offset=ue,R&&Y!==Z&&n("change",f.value)},V=()=>{a.swiping=!0,a.active<=-1?z({pace:o.value}):a.active>=o.value&&z({pace:-o.value})},q=()=>{V(),b.reset(),me(()=>{a.swiping=!1,z({pace:-1,emitChange:!0})})},r=()=>{V(),b.reset(),me(()=>{a.swiping=!1,z({pace:1,emitChange:!0})})};let y;const O=()=>clearTimeout(y),x=()=>{O(),+e.autoplay>0&&o.value>1&&(y=setTimeout(()=>{r(),x()},+e.autoplay))},F=(u=+e.initialSwipe)=>{if(!t.value)return;const I=()=>{var R,Z;if(!xe(t)){const Y={width:t.value.offsetWidth,height:t.value.offsetHeight};a.rect=Y,a.width=+((R=e.width)!=null?R:Y.width),a.height=+((Z=e.height)!=null?Z:Y.height)}o.value&&(u=Math.min(o.value-1,u),u===-1&&(u=o.value-1)),a.active=u,a.swiping=!0,a.offset=M(u),m.forEach(Y=>{Y.setOffset(0)}),x()};xe(t)?ie().then(I):I()},X=()=>F(a.active);let J;const Q=u=>{!e.touchable||u.touches.length>1||(b.start(u),S=!1,J=Date.now(),O(),V())},c=u=>{e.touchable&&a.swiping&&(b.move(u),_.value&&(!e.loop&&(a.active===0&&s.value>0||a.active===o.value-1&&s.value<0)||(he(u,e.stopPropagation),z({offset:s.value}),S||(n("dragStart",{index:f.value}),S=!0))))},h=()=>{if(!e.touchable||!a.swiping)return;const u=Date.now()-J,I=s.value/u;if((Math.abs(I)>.25||Math.abs(s.value)>v.value/2)&&_.value){const Z=e.vertical?b.offsetY.value:b.offsetX.value;let Y=0;e.loop?Y=Z>0?s.value>0?-1:1:0:Y=-Math[s.value>0?"ceil":"floor"](s.value/v.value),z({pace:Y,emitChange:!0})}else s.value&&z({pace:0});S=!1,a.swiping=!1,n("dragEnd",{index:f.value}),x()},C=(u,I={})=>{V(),b.reset(),me(()=>{let R;e.loop&&u===o.value?R=a.active===0?0:u:R=u%o.value,I.immediate?me(()=>{a.swiping=!1}):a.swiping=!1,z({pace:R-a.active,emitChange:!0})})},$=(u,I)=>{const R=I===f.value,Z=R?{backgroundColor:e.indicatorColor}:void 0;return d("i",{style:Z,class:ge("indicator",{active:R})},null)},U=()=>{if(l.indicator)return l.indicator({active:f.value,total:o.value});if(e.showIndicators&&o.value>1)return d("div",{class:ge("indicators",{vertical:e.vertical})},[Array(o.value).fill("").map($)])};return re({prev:q,next:r,state:a,resize:X,swipeTo:C}),g({size:v,props:e,count:o,activeIndicator:f}),j(()=>e.initialSwipe,u=>F(+u)),j(o,()=>F(a.active)),j(()=>e.autoplay,x),j([Le,De,()=>e.width,()=>e.height],X),j(qe(),u=>{u==="visible"?x():O()}),ye(F),st(()=>F(a.active)),Je(()=>F(a.active)),ct(O),Pe(O),Fe("touchmove",c,{target:i}),()=>{var u;return d("div",{ref:t,class:ge()},[d("div",{ref:i,style:E.value,class:ge("track",{vertical:e.vertical}),onTouchstartPassive:Q,onTouchend:h,onTouchcancel:h},[(u=l.default)==null?void 0:u.call(l)]),U()])}}});const bt=fe(wt),[yt,Ct]=se("swipe-item");var St=p({name:yt,setup(e,{slots:n}){let l;const t=ce({offset:0,inited:!1,mounted:!1}),{parent:i,index:a}=Qe(He);if(!i)return;const S=B(()=>{const g={},{vertical:o}=i.props;return i.size.value&&(g[o?"height":"width"]=`${i.size.value}px`),t.offset&&(g.transform=`translate${o?"Y":"X"}(${t.offset}px)`),g}),b=B(()=>{const{loop:g,lazyRender:o}=i.props;if(!o||l)return!0;if(!t.mounted)return!1;const v=i.activeIndicator.value,s=i.count.value-1,w=v===0&&g?s:v-1,k=v===s&&g?0:v+1;return l=a.value===v||a.value===w||a.value===k,l}),m=g=>{t.offset=g};return ye(()=>{ie(()=>{t.mounted=!0})}),re({setOffset:m}),()=>{var g;return d("div",{class:Ct(),style:S.value},[b.value?(g=n.default)==null?void 0:g.call(n):null])}}});const kt=fe(St);function Pt(){const e=ce({show:!1}),n=i=>{e.show=i},l=i=>{le(e,i,{transitionAppear:!0}),n(!0)},t=()=>n(!1);return re({open:l,close:t,toggle:n}),{open:l,close:t,state:e,toggle:n}}function xt(e){const n=rt(e),l=document.createElement("div");return document.body.appendChild(l),{instance:n.mount(l),unmount(){n.unmount(),document.body.removeChild(l)}}}const It={name:be,disabled:Boolean,iconSize:N,modelValue:be,checkedColor:String,labelPosition:String,labelDisabled:Boolean};var na=p({props:le({},It,{bem:oe(Function),role:String,shape:String,parent:Object,checked:Boolean,bindGroup:D,indeterminate:{type:Boolean,default:null}}),emits:["click","toggle"],setup(e,{emit:n,slots:l}){const t=A(),i=s=>{if(e.parent&&e.bindGroup)return e.parent.props[s]},a=B(()=>{if(e.parent&&e.bindGroup){const s=i("disabled")||e.disabled;if(e.role==="checkbox"){const w=i("modelValue").length,k=i("max"),T=k&&w>=+k;return s||T&&!e.checked}return s}return e.disabled}),S=B(()=>i("direction")),b=B(()=>{const s=e.checkedColor||i("checkedColor");if(s&&(e.checked||e.indeterminate)&&!a.value)return{borderColor:s,backgroundColor:s}}),m=B(()=>e.shape||i("shape")||"round"),g=s=>{const{target:w}=s,k=t.value,T=k===w||(k==null?void 0:k.contains(w));!a.value&&(T||!e.labelDisabled)&&n("toggle"),n("click",s)},o=()=>{var s,w;const{bem:k,checked:T,indeterminate:f}=e,_=e.iconSize||i("iconSize");return d("div",{ref:t,class:k("icon",[m.value,{disabled:a.value,checked:T,indeterminate:f}]),style:m.value!=="dot"?{fontSize:ne(_)}:{width:ne(_),height:ne(_),borderColor:(s=b.value)==null?void 0:s.borderColor}},[l.icon?l.icon({checked:T,disabled:a.value}):m.value!=="dot"?d(K,{name:f?"minus":"success",style:b.value},null):d("div",{class:k("icon--dot__icon"),style:{backgroundColor:(w=b.value)==null?void 0:w.backgroundColor}},null)])},v=()=>{const{checked:s}=e;if(l.default)return d("span",{class:e.bem("label",[e.labelPosition,{disabled:a.value}])},[l.default({checked:s,disabled:a.value})])};return()=>{const s=e.labelPosition==="left"?[v(),o()]:[o(),v()];return d("div",{role:e.role,class:e.bem([{disabled:a.value,"label-disabled":e.labelDisabled},S.value]),tabindex:a.value?void 0:0,"aria-checked":e.checked,onClick:g},[s])}}});const[zt,te]=se("image"),Rt={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:N,height:N,radius:N,lazyLoad:Boolean,iconSize:N,showError:D,errorIcon:G("photo-fail"),iconPrefix:String,showLoading:D,loadingIcon:G("photo"),crossorigin:String,referrerpolicy:String,decoding:String};var _t=p({name:zt,props:Rt,emits:["load","error"],setup(e,{emit:n,slots:l}){const t=A(!1),i=A(!0),a=A(),{$Lazyload:S}=ut().proxy,b=B(()=>{const f={width:ne(e.width),height:ne(e.height)};return $e(e.radius)&&(f.overflow="hidden",f.borderRadius=ne(e.radius)),f});j(()=>e.src,()=>{t.value=!1,i.value=!0});const m=f=>{i.value&&(i.value=!1,n("load",f))},g=()=>{const f=new Event("load");Object.defineProperty(f,"target",{value:a.value,enumerable:!0}),m(f)},o=f=>{t.value=!0,i.value=!1,n("error",f)},v=(f,_,E)=>E?E():d(K,{name:f,size:e.iconSize,class:_,classPrefix:e.iconPrefix},null),s=()=>{if(i.value&&e.showLoading)return d("div",{class:te("loading")},[v(e.loadingIcon,te("loading-icon"),l.loading)]);if(t.value&&e.showError)return d("div",{class:te("error")},[v(e.errorIcon,te("error-icon"),l.error)])},w=()=>{if(t.value||!e.src)return;const f={alt:e.alt,class:te("img"),decoding:e.decoding,style:{objectFit:e.fit,objectPosition:e.position},crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy};return e.lazyLoad?ke(d("img",ve({ref:a},f),null),[[dt("lazy"),e.src]]):d("img",ve({ref:a,src:e.src,onLoad:m,onError:o},f),null)},k=({el:f})=>{const _=()=>{f===a.value&&i.value&&g()};a.value?_():ie(_)},T=({el:f})=>{f===a.value&&!t.value&&o()};return S&&Ae&&(S.$on("loaded",k),S.$on("error",T),Pe(()=>{S.$off("loaded",k),S.$off("error",T)})),ye(()=>{ie(()=>{var f;(f=a.value)!=null&&f.complete&&!e.lazyLoad&&g()})}),()=>{var f;return d("div",{class:te({round:e.round,block:e.block}),style:b.value},[w(),s(),(f=l.default)==null?void 0:f.call(l)])}}});const Ne=fe(_t),Oe=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),Ot=e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}),Se=se("image-preview")[1],Be=2.6,Bt={src:String,show:Boolean,active:Number,minZoom:oe(N),maxZoom:oe(N),rootWidth:oe(Number),rootHeight:oe(Number),disableZoom:Boolean,doubleScale:Boolean,closeOnClickImage:Boolean,closeOnClickOverlay:Boolean,vertical:Boolean};var Tt=p({props:Bt,emits:["scale","close","longPress"],setup(e,{emit:n,slots:l}){const t=ce({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),i=Ze(),a=A(),S=A(),b=A(!1),m=A(!1);let g=0;const o=B(()=>{const{scale:c,moveX:h,moveY:C,moving:$,zooming:U,initializing:u}=t,I={transitionDuration:U||$||u?"0s":".3s"};return(c!==1||m.value)&&(I.transform=`matrix(${c}, 0, 0, ${c}, ${h}, ${C})`),I}),v=B(()=>{if(t.imageRatio){const{rootWidth:c,rootHeight:h}=e,C=b.value?h/t.imageRatio:c;return Math.max(0,(t.scale*C-c)/2)}return 0}),s=B(()=>{if(t.imageRatio){const{rootWidth:c,rootHeight:h}=e,C=b.value?h:c*t.imageRatio;return Math.max(0,(t.scale*C-h)/2)}return 0}),w=(c,h)=>{var C;if(c=H(c,+e.minZoom,+e.maxZoom+1),c!==t.scale){const $=c/t.scale;if(t.scale=c,h){const U=Ee((C=a.value)==null?void 0:C.$el),u={x:U.width*.5,y:U.height*.5},I=t.moveX-(h.x-U.left-u.x)*($-1),R=t.moveY-(h.y-U.top-u.y)*($-1);t.moveX=H(I,-v.value,v.value),t.moveY=H(R,-s.value,s.value)}else t.moveX=0,t.moveY=m.value?g:0;n("scale",{scale:c,index:e.active})}},k=()=>{w(1)},T=()=>{const c=t.scale>1?1:2;w(c,c===2||m.value?{x:i.startX.value,y:i.startY.value}:void 0)};let f,_,E,P,M,z,V,q,r=!1;const y=c=>{const{touches:h}=c;if(f=h.length,f===2&&e.disableZoom)return;const{offsetX:C}=i;i.start(c),_=t.moveX,E=t.moveY,q=Date.now(),r=!1,t.moving=f===1&&(t.scale!==1||m.value),t.zooming=f===2&&!C.value,t.zooming&&(P=t.scale,M=Oe(h))},O=c=>{const{touches:h}=c;if(i.move(c),t.moving){const{deltaX:C,deltaY:$}=i,U=C.value+_,u=$.value+E;if((e.vertical?i.isVertical()&&Math.abs(u)>s.value:i.isHorizontal()&&Math.abs(U)>v.value)&&!r){t.moving=!1;return}r=!0,he(c,!0),t.moveX=H(U,-v.value,v.value),t.moveY=H(u,-s.value,s.value)}if(t.zooming&&(he(c,!0),h.length===2)){const C=Oe(h),$=P*C/M;z=Ot(h),w($,z)}},x=c=>{var h;const C=(h=S.value)==null?void 0:h.$el;if(!C)return;const $=C.firstElementChild,U=c.target===C,u=$==null?void 0:$.contains(c.target);!e.closeOnClickImage&&u||!e.closeOnClickOverlay&&U||n("close")},F=c=>{if(f>1)return;const h=Date.now()-q,C=250;i.isTap.value&&(h<C?e.doubleScale?V?(clearTimeout(V),V=null,T()):V=setTimeout(()=>{x(c),V=null},C):x(c):h>tt&&n("longPress"))},X=c=>{let h=!1;if((t.moving||t.zooming)&&(h=!0,t.moving&&_===t.moveX&&E===t.moveY&&(h=!1),!c.touches.length)){t.zooming&&(t.moveX=H(t.moveX,-v.value,v.value),t.moveY=H(t.moveY,-s.value,s.value),t.zooming=!1),t.moving=!1,_=0,E=0,P=1,t.scale<1&&k();const C=+e.maxZoom;t.scale>C&&w(C,z)}he(c,h),F(c),i.reset()},J=()=>{const{rootWidth:c,rootHeight:h}=e,C=h/c,{imageRatio:$}=t;b.value=t.imageRatio>C&&$<Be,m.value=t.imageRatio>C&&$>=Be,m.value&&(g=($*c-h)/2,t.moveY=g,t.initializing=!0,et(()=>{t.initializing=!1})),k()},Q=c=>{const{naturalWidth:h,naturalHeight:C}=c.target;t.imageRatio=C/h,J()};return j(()=>e.active,k),j(()=>e.show,c=>{c||k()}),j(()=>[e.rootWidth,e.rootHeight],J),Fe("touchmove",O,{target:B(()=>{var c;return(c=S.value)==null?void 0:c.$el})}),re({resetScale:k}),()=>{const c={loading:()=>d(Ve,{type:"spinner"},null)};return d(kt,{ref:S,class:Se("swipe-item"),onTouchstartPassive:y,onTouchend:X,onTouchcancel:X},{default:()=>[l.image?d("div",{class:Se("image-wrap")},[l.image({src:e.src,onLoad:Q,style:o.value})]):d(Ne,{ref:a,src:e.src,fit:"contain",class:Se("image",{vertical:b.value}),style:o.value,onLoad:Q},c)]})}}});const[Lt,ae]=se("image-preview"),Dt=["show","teleport","transition","overlayStyle","closeOnPopstate"],Ft={show:Boolean,loop:D,images:Me(),minZoom:W(1/3),maxZoom:W(3),overlay:D,vertical:Boolean,closeable:Boolean,showIndex:D,className:be,closeIcon:G("clear"),transition:String,beforeClose:Function,doubleScale:D,overlayClass:be,overlayStyle:Object,swipeDuration:W(300),startPosition:W(0),showIndicators:Boolean,closeOnPopstate:D,closeOnClickImage:D,closeOnClickOverlay:D,closeIconPosition:G("top-right"),teleport:[String,Object]};var We=p({name:Lt,props:Ft,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:n,slots:l}){const t=A(),i=A(),a=ce({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),S=()=>{if(t.value){const P=Ee(t.value.$el);a.rootWidth=P.width,a.rootHeight=P.height,t.value.resize()}},b=P=>n("scale",P),m=P=>n("update:show",P),g=()=>{Xe(e.beforeClose,{args:[a.active],done:()=>m(!1)})},o=P=>{P!==a.active&&(a.active=P,n("change",P))},v=()=>{if(e.showIndex)return d("div",{class:ae("index")},[l.index?l.index({index:a.active}):`${a.active+1} / ${e.images.length}`])},s=()=>{if(l.cover)return d("div",{class:ae("cover")},[l.cover()])},w=()=>{a.disableZoom=!0},k=()=>{a.disableZoom=!1},T=()=>d(bt,{ref:t,lazyRender:!0,loop:e.loop,class:ae("swipe"),vertical:e.vertical,duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:o,onDragEnd:k,onDragStart:w},{default:()=>[e.images.map((P,M)=>d(Tt,{ref:z=>{M===a.active&&(i.value=z)},src:P,show:e.show,active:a.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:a.rootWidth,rootHeight:a.rootHeight,disableZoom:a.disableZoom,doubleScale:e.doubleScale,closeOnClickImage:e.closeOnClickImage,closeOnClickOverlay:e.closeOnClickOverlay,vertical:e.vertical,onScale:b,onClose:g,onLongPress:()=>n("longPress",{index:M})},{image:l.image}))]}),f=()=>{if(e.closeable)return d(K,{role:"button",name:e.closeIcon,class:[ae("close-icon",e.closeIconPosition),at],onClick:g},null)},_=()=>n("closed"),E=(P,M)=>{var z;return(z=t.value)==null?void 0:z.swipeTo(P,M)};return re({resetScale:()=>{var P;(P=i.value)==null||P.resetScale()},swipeTo:E}),ye(S),j([Le,De],S),j(()=>e.startPosition,P=>o(+P)),j(()=>e.show,P=>{const{images:M,startPosition:z}=e;P?(o(+z),ie(()=>{S(),E(+z,{immediate:!0})})):n("close",{index:a.active,url:M[a.active]})}),()=>d(gt,ve({class:[ae(),e.className],overlayClass:[ae("overlay"),e.overlayClass],onClosed:_,"onUpdate:show":m},de(e,Dt)),{default:()=>[f(),T(),v(),s()]})}});let we;const $t={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,vertical:!1,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,doubleScale:!0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function At(){({instance:we}=xt({setup(){const{state:e,toggle:n}=Pt(),l=()=>{e.images=[]};return()=>d(We,ve(e,{onClosed:l,"onUpdate:show":n}),null)}}))}const Et=(e,n=0)=>{if(Ae)return we||At(),e=Array.isArray(e)?{images:e,startPosition:n}:e,we.open(le({},$t,e)),we};fe(We);const[Mt,L,Xt]=se("uploader");function Te(e,n){return new Promise(l=>{if(n==="file"){l();return}const t=new FileReader;t.onload=i=>{l(i.target.result)},n==="dataUrl"?t.readAsDataURL(e):n==="text"&&t.readAsText(e)})}function pe(e,n){return Ue(e).some(l=>l.file?ot(n)?n(l.file):l.file.size>+n:!1)}function Ut(e,n){const l=[],t=[];return e.forEach(i=>{pe(i,n)?t.push(i):l.push(i)}),{valid:l,invalid:t}}const Yt=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,Vt=e=>Yt.test(e);function Ge(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?Vt(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var Zt=p({props:{name:N,item:oe(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:n,slots:l}){const t=()=>{const{status:o,message:v}=e.item;if(o==="uploading"||o==="failed"){const s=o==="failed"?d(K,{name:"close",class:L("mask-icon")},null):d(Ve,{class:L("loading")},null),w=$e(v)&&v!=="";return d("div",{class:L("mask")},[s,w&&d("div",{class:L("mask-message")},[v])])}},i=o=>{const{name:v,item:s,index:w,beforeDelete:k}=e;o.stopPropagation(),Xe(k,{args:[s,{name:v,index:w}],done:()=>n("delete")})},a=()=>n("preview"),S=()=>n("reupload"),b=()=>{if(e.deletable&&e.item.status!=="uploading"){const o=l["preview-delete"];return d("div",{role:"button",class:L("preview-delete",{shadow:!o}),tabindex:0,"aria-label":Xt("delete"),onClick:i},[o?o():d(K,{name:"cross",class:L("preview-delete-icon")},null)])}},m=()=>{if(l["preview-cover"]){const{index:o,item:v}=e;return d("div",{class:L("preview-cover")},[l["preview-cover"](le({index:o},v))])}},g=()=>{const{item:o,lazyLoad:v,imageFit:s,previewSize:w,reupload:k}=e;return Ge(o)?d(Ne,{fit:s,src:o.objectUrl||o.content||o.url,class:L("preview-image"),width:Array.isArray(w)?w[0]:w,height:Array.isArray(w)?w[1]:w,lazyLoad:v,onClick:k?S:a},{default:m}):d("div",{class:L("file"),style:Ye(e.previewSize)},[d(K,{class:L("file-icon"),name:"description"},null),d("div",{class:[L("file-name"),"van-ellipsis"]},[o.file?o.file.name:o.url]),m()])};return()=>d("div",{class:L("preview")},[g(),t(),b()])}});const jt={name:W(""),accept:G("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:W(1/0),imageFit:G("cover"),resultType:G("dataUrl"),uploadIcon:G("photograph"),uploadText:String,deletable:D,reupload:Boolean,afterRead:Function,showUpload:D,modelValue:Me(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:D,previewOptions:Object,previewFullImage:D,maxSize:{type:[Number,String,Function],default:1/0}};var Ht=p({name:Mt,props:jt,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:n,slots:l}){const t=A(),i=[],a=A(-1),S=A(!1),b=(r=e.modelValue.length)=>({name:e.name,index:r}),m=()=>{t.value&&(t.value.value="")},g=r=>{if(m(),pe(r,e.maxSize))if(Array.isArray(r)){const y=Ut(r,e.maxSize);if(r=y.valid,n("oversize",y.invalid,b()),!r.length)return}else{n("oversize",r,b());return}if(r=ce(r),a.value>-1){const y=[...e.modelValue];y.splice(a.value,1,r),n("update:modelValue",y),a.value=-1}else n("update:modelValue",[...e.modelValue,...Ue(r)]);e.afterRead&&e.afterRead(r,b())},o=r=>{const{maxCount:y,modelValue:O,resultType:x}=e;if(Array.isArray(r)){const F=+y-O.length;r.length>F&&(r=r.slice(0,F)),Promise.all(r.map(X=>Te(X,x))).then(X=>{const J=r.map((Q,c)=>{const h={file:Q,status:"",message:"",objectUrl:URL.createObjectURL(Q)};return X[c]&&(h.content=X[c]),h});g(J)})}else Te(r,x).then(F=>{const X={file:r,status:"",message:"",objectUrl:URL.createObjectURL(r)};F&&(X.content=F),g(X)})},v=r=>{const{files:y}=r.target;if(e.disabled||!y||!y.length)return;const O=y.length===1?y[0]:[].slice.call(y);if(e.beforeRead){const x=e.beforeRead(O,b());if(!x){m();return}if(lt(x)){x.then(F=>{o(F||O)}).catch(m);return}}o(O)};let s;const w=()=>n("closePreview"),k=r=>{if(e.previewFullImage){const y=e.modelValue.filter(Ge),O=y.map(x=>(x.objectUrl&&!x.url&&x.status!=="failed"&&(x.url=x.objectUrl,i.push(x.url)),x.url)).filter(Boolean);s=Et(le({images:O,startPosition:y.indexOf(r),onClose:w},e.previewOptions))}},T=()=>{s&&s.close()},f=(r,y)=>{const O=e.modelValue.slice(0);O.splice(y,1),n("update:modelValue",O),n("delete",r,b(y))},_=r=>{S.value=!0,a.value=r,ie(()=>q())},E=()=>{S.value||(a.value=-1),S.value=!1},P=(r,y)=>{const O=["imageFit","deletable","reupload","previewSize","beforeDelete"],x=le(de(e,O),de(r,O,!0));return d(Zt,ve({item:r,index:y,onClick:()=>n(e.reupload?"clickReupload":"clickPreview",r,b(y)),onDelete:()=>f(r,y),onPreview:()=>k(r),onReupload:()=>_(y)},de(e,["name","lazyLoad"]),x),de(l,["preview-cover","preview-delete"]))},M=()=>{if(e.previewImage)return e.modelValue.map(P)},z=r=>n("clickUpload",r),V=()=>{const r=e.modelValue.length<+e.maxCount,y=e.readonly?null:d("input",{ref:t,type:"file",class:L("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&a.value===-1,disabled:e.disabled,onChange:v,onClick:E},null);return l.default?ke(d("div",{class:L("input-wrapper"),onClick:z},[l.default(),y]),[[Ie,r]]):ke(d("div",{class:L("upload",{readonly:e.readonly}),style:Ye(e.previewSize),onClick:z},[d(K,{name:e.uploadIcon,class:L("upload-icon")},null),e.uploadText&&d("span",{class:L("upload-text")},[e.uploadText]),y]),[[Ie,e.showUpload&&r]])},q=()=>{t.value&&!e.disabled&&t.value.click()};return Pe(()=>{i.forEach(r=>URL.revokeObjectURL(r))}),re({chooseFile:q,reuploadFile:_,closeImagePreview:T}),nt(()=>e.modelValue),()=>d("div",{class:L()},[d("div",{class:L("wrapper",{disabled:e.disabled})},[M(),V()])])}});const Nt=fe(Ht),Wt={class:"upload-area"},pt={key:0,class:"file-card"},Gt={class:"file-info"},Kt={class:"file-name"},qt={class:"file-size"},Jt=p({__name:"FileUploadSection",props:{selectedFile:{},detectedProvider:{}},emits:["file-selected"],setup(e,{emit:n}){const l=n,t=B(()=>[]),i=m=>{var o;const g=Array.isArray(m)?(o=m[0])==null?void 0:o.file:m==null?void 0:m.file;g&&l("file-selected",g)},a=()=>{l("file-selected",null)},S=m=>{if(m===0)return"0 B";const g=1024,o=["B","KB","MB","GB"],v=Math.floor(Math.log(m)/Math.log(g));return parseFloat((m/Math.pow(g,v)).toFixed(2))+" "+o[v]},b=()=>{l("file-selected",null)};return(m,g)=>{const o=K,v=Nt,s=mt;return _e(),ze("div",null,[d(v,{"file-list":t.value,"max-count":1,accept:".csv,.xls,.xlsx","after-read":i,onDelete:a},{default:ft(()=>[ee("div",Wt,[d(o,{name:"upgrade",size:"48",color:"#c8c9cc"}),g[0]||(g[0]=ee("p",{class:"upload-text"},"点击或拖拽文件到此处上传",-1)),g[1]||(g[1]=ee("p",{class:"upload-hint"},"支持 CSV, XLS, XLSX",-1))])]),_:1},8,["file-list"]),e.selectedFile?(_e(),ze("div",pt,[ee("div",Gt,[ee("p",Kt,Re(e.selectedFile.name),1),ee("p",qt,"大小: "+Re(S(e.selectedFile.size)),1)]),d(s,{size:"small",type:"danger",plain:"",round:"",icon:"cross",onClick:b})])):vt("",!0)])}}}),la=it(Jt,[["__scopeId","data-v-9b077289"]]);export{la as F,It as c,na as s};
